<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
</head>
<body>
<!-- Mobile Header Fragment -->
<div th:fragment="mobile-header">
    <!-- Mobile Header -->
    <div class="md:hidden bg-primary-800 dark:bg-darkpurple-900 text-white p-4 flex justify-between items-center shadow-elevation-2 transition-colors duration-300">
        <h1 class="text-xl font-bold">Administrator Panel</h1>
        <button id="mobileMenuBtn"
                class="material-btn text-white p-1 rounded-full hover:bg-primary-700 dark:hover:bg-darkpurple-800 transition-colors duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                 stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
        </button>
    </div>

    <!-- Mobile Menu -->
    <div id="mobileMenu"
         class="md:hidden bg-primary-800 dark:bg-darkpurple-900 text-white p-4 hidden shadow-elevation-3 animate-fade-in transition-colors duration-300">
        <nav>
            <ul>
                <li class="mb-2">
                    <a href="/admin"
                       class="block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1"
                       th:class="${#httpServletRequest != null && #httpServletRequest.requestURI != null && #httpServletRequest.requestURI == '/admin' ? 'block py-2 px-4 bg-primary-700 dark:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 shadow-elevation-1' : 'block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1'}">
                        Dashboard
                    </a>
                </li>
                <li class="mb-2" th:if="${#authorization.expression('hasAuthority(''ADMIN'')')}">
                    <a href="/admin/users"
                       class="block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1"
                       th:class="${#httpServletRequest != null && #httpServletRequest.requestURI != null && #httpServletRequest.requestURI.startsWith('/admin/users') ? 'block py-2 px-4 bg-primary-700 dark:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 shadow-elevation-1' : 'block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1'}">
                        User Management
                    </a>
                </li>
                <li class="mb-2" th:if="${#authorization.expression('hasAuthority(''ADMIN'')')}">
                    <a href="/admin/moderators"
                       class="block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1"
                       th:class="${#httpServletRequest != null && #httpServletRequest.requestURI != null && #httpServletRequest.requestURI.startsWith('/admin/moderators') ? 'block py-2 px-4 bg-primary-700 dark:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 shadow-elevation-1' : 'block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1'}">
                        Manage Moderators
                    </a>
                </li>
                <li class="mb-2" th:if="${#authorization.expression('hasAnyAuthority(''ADMIN'', ''MODERATOR'')')}">
                    <a href="/moderator/tasks"
                       class="block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1"
                       th:class="${#httpServletRequest != null && #httpServletRequest.requestURI != null && #httpServletRequest.requestURI.startsWith('/moderator/tasks') ? 'block py-2 px-4 bg-primary-700 dark:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 shadow-elevation-1' : 'block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1'}">
                        Task Management
                    </a>
                </li>
                <li class="mb-2" th:if="${#authorization.expression('hasAuthority(''ADMIN'')')}">
                    <a href="/analytics/admin"
                       class="block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1"
                       th:class="${#httpServletRequest != null && #httpServletRequest.requestURI != null && #httpServletRequest.requestURI == '/analytics/admin' ? 'block py-2 px-4 bg-primary-700 dark:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 shadow-elevation-1' : 'block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1'}">
                        Analytics Dashboard
                    </a>
                </li>
                <li class="mb-2">
                    <a href="/analytics/user"
                       class="block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1"
                       th:class="${#httpServletRequest != null && #httpServletRequest.requestURI != null && #httpServletRequest.requestURI == '/analytics/user' ? 'block py-2 px-4 bg-primary-700 dark:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 shadow-elevation-1' : 'block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1'}">
                        My Analytics
                    </a>
                </li>
                <li class="mb-2">
                    <a href="/tasks"
                       class="block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1">
                        View Public Site
                    </a>
                </li>
                <li class="mb-2">
                    <a href="/change-password"
                       class="block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1"
                       th:class="${#httpServletRequest != null && #httpServletRequest.requestURI != null && #httpServletRequest.requestURI == '/change-password' ? 'block py-2 px-4 bg-primary-700 dark:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 shadow-elevation-1' : 'block py-2 px-4 hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1'}">
                        Change Password
                    </a>
                </li>

                <!-- Dark mode toggle in mobile menu -->
                <li class="mb-4 flex justify-center">
                    <button id="mobile-theme-toggle"
                            class="theme-toggle bg-primary-700 dark:bg-darkpurple-800 p-2 rounded-full transition-colors duration-300"
                            aria-label="Toggle dark mode" aria-checked="false">
                        <svg class="moon-icon w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                        </svg>
                        <svg class="sun-icon w-5 h-5 text-yellow-300 hidden" fill="none" stroke="currentColor"
                             viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                    </button>
                </li>

                <li class="mt-4">
                    <form th:action="@{/logout}" method="post">
                        <button type="submit"
                                class="material-btn block w-full py-2 px-4 text-left hover:bg-primary-700 dark:hover:bg-darkpurple-800 rounded-lg font-medium transition-all duration-300 hover:shadow-elevation-1">
                            Logout
                        </button>
                    </form>
                </li>
            </ul>
        </nav>
    </div>
</div>
</body>
</html>
